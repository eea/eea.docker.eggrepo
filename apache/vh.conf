<VirtualHost *:80>
  ServerAdmin helpdesk@eea.europa.eu
  ServerName eggrepo.apps.eea.europa.eu
  <LocationMatch "^/(?!(simple|pypi|(.+)\.gif|(.+)\.jpg|(.+)\.css|(.+)\.gz|(.+)\.zip))">

    AuthBasicProvider ldap
    AuthName        pypi
    AuthType        Basic
    AuthLDAPUrl ldap://ldap.eionet.europa.eu/ou=Users,o=Eionet,l=Europe?uid
    <Limit POST>
      Require valid-user
    </Limit>

  </LocationMatch>

  RewriteEngine On
  RewriteRule ^/pypi(.*) http://pypi.python.org/simple$1 [R=permanent,L]

  ProxyPass / http://eggrepo:9090/
  ProxyPassReverse / http://eggrepo:9090/

</VirtualHost>
